#Nodo
1. Metodologia de "barrido": En la metodologia, la atencion se centra en familias especificas de malware, sus IOC asociados y las tacticas, tecnicas y procedimientos especificos de esa campaña de ataque o ese grupo de malware. El ataque generalmente comienza con una campaña de ataque general publicada en las noticias o en un blog de inteligencia de amenazas de codigo abierto.
   PAN tiene su propia unidad de inteligencia de amenazas: unit42 publica regularmente blogs sobre las ultimas campañas de los atacantes.
   
   Llevar a cabo una busqueda de amenazas para comportamientos especificos de la campaña:
   - Investigacion: Empieza por investigar el ataque (contexto del ataque, IOCs, tacticas especificas de los atacantes que se podrian buscar)
   - Identificar: Identifica todos los IOC y los indicadores que son exclusivos de esa campaña
   - Buscar: Busque puntos de conexion, su red y la nube. Tienen mecanismos de deteccion integrados de Cortex XDR que barren todo el entorno.

2. Caza del gorrion plateado: Silver Sparrow es una nueva cepa de malware que ataca a los sistemas MAC. La novedad de este malware proviene principalmente de la forma en que utiliza JavaScript para la ejecucion, la explotacion y la instalacion. El malware es particularmente interesante debido a su nueva variante y porque se dirige a los sistemas MAC. Infecto 29139 endpoints de macos.
   
   Como funciona silver sparrow: Para entender como funciona silver sparrow, usemos el ciclo de vida de progresion del atacante que vimos anteriormente y asignemoslo a como se comporta el silver sparrow
   - Explotacion: Esta familia de malware usa JS para su ejecucion y contiene dos paquete especificos malicosos
   - Instalacion: Una vez que el malware tiene los paquetes especificos, se instala mediante comandos JS maliciosos. usa una aplicacion llamada PListBuddy para iniciar un agente en las maquinas MAc de la victima. 
   - Comando y control: El malware se conecta a buckets maliciosos de AWS S3 para distribuir el contenido de la maquina victima y extraer mas instrucciones C2 ( Generalmente en forma de plantillas .json). Silver Sparrow "riza" especificamente estas instrucciones JSON de los dominios S3 maliciosos
   - Acciones sobre objetivos: Finalmente, el malware se encuentra la URL original desde la que se descargo el paquete y ejecuta una consulta SQLite3. Esta consulta indica al adversario que el malware se ha instalado y que sus canales de distribucion se han configurado correctamente.

3. Caso de estudio: Caza de malware para silver Sparrow: Este estudio de caso muestra la tecnica de busqueda orientada a la familia de malware para cazar silver Sparrow, un cluster de malware para MAC, usando XQL
   
   Ciclo de vida de caza para silver sparrow:
   - Comienzo: Comenzamos investigando los comportamientos y las IOC de silver sparrow
   - Formacion de casos de uso: Compruebe la posible actividad de C2 buscando todos los procesos de MAC que llaman a buckets de Amazon S3 y todos los IOC conocidos.
   - Recoleccion de herramientas: utilice las onsultas de Cortex XDR XQL y los IOC de cortex XDR como herramientas para esta consulta.
   - Traducccion de casos de uso a firmas o analisis de datos: Construir la consulta XQL de Cortex XDR yendo a investigacion > Generador de consultas > XQL. Los comportamientos especificos observados en este grupo de malware lo ayudaran a comprender que otros paquetes dentro de MAc se comportan de manera similar.
     
    En el generador de XQL construya la consulta que se muestra a continuacion para buscar el comportamiento C2 observado
    
   - Caza e investigacion: Realizar la investigacion en funcion de los resultados de la consulta.

4. Para mostrar los sistemas MacOS que muestran persistencia a través de las aplicaciones PListBuddy y LaunchAgents, ejecute la siguiente consulta:
_conjunto de datos = xdr_data_
_| filtro agent_os_type = AGENT_OS_MAC_
_| filtro actor_process_command_line = "*PlistBuddy*LaunchAgents*"_

Para mostrar los comportamientos de MacOS que ejecutan una consulta SQLite3 para indicar que la instalación se ha realizado correctamente en el servidor C2, ejecute la siguiente consulta:
_conjunto de datos = xdr_data_
_| filtro agent_os_type = AGENT_OS_MAC_
_| filtro actor_process_command_line = "*LSQuarantine*"_

